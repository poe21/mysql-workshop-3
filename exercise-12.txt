Exercise 12
* List 100 phone numbers in separated parts: country code, area code and line number

mysql> SELECT content AS fullPhoneNumber,
content LIKE "1-%" OR NULL AS countryCode,
CASE
    WHEN content NOT LIKE "%(%" THEN SUBSTRING_INDEX(SUBSTRING_INDEX(content, "-", 2), "-", -1)
    WHEN content LIKE "%(%" THEN SUBSTRING_INDEX(SUBSTRING_INDEX(content, "(", -1), ")", 1)
END AS areaCode,
RIGHT(content, 8) AS lineNumber FROM Phone ORDER BY countryCode LIMIT 100;

+-----------------+-------------+----------+------------+
| fullPhoneNumber | countryCode | areaCode | lineNumber |
+-----------------+-------------+----------+------------+
| (726) 732-1076  |        NULL | 726      | 732-1076   |
| (646) 640-1430  |        NULL | 646      | 640-1430   |
| (111) 396-3055  |        NULL | 111      | 396-3055   |
| (605) 230-7173  |        NULL | 605      | 230-7173   |
| (397) 966-5700  |        NULL | 397      | 966-5700   |
| (594) 756-8455  |        NULL | 594      | 756-8455   |
| (487) 897-3861  |        NULL | 487      | 897-3861   |
| (282) 869-7478  |        NULL | 282      | 869-7478   |
| (255) 647-1196  |        NULL | 255      | 647-1196   |
| (169) 195-3964  |        NULL | 169      | 195-3964   |
| (719) 441-1506  |        NULL | 719      | 441-1506   |
| (840) 607-2973  |        NULL | 840      | 607-2973   |
| (956) 901-1794  |        NULL | 956      | 901-1794   |
| (778) 799-6921  |        NULL | 778      | 799-6921   |
| (297) 648-9955  |        NULL | 297      | 648-9955   |
| (392) 459-7615  |        NULL | 392      | 459-7615   |
| (138) 486-5328  |        NULL | 138      | 486-5328   |
| (504) 381-1187  |        NULL | 504      | 381-1187   |
| (236) 569-9186  |        NULL | 236      | 569-9186   |
| (427) 373-9039  |        NULL | 427      | 373-9039   |
| (170) 776-2226  |        NULL | 170      | 776-2226   |
| (588) 653-2753  |        NULL | 588      | 653-2753   |
| (401) 921-5802  |        NULL | 401      | 921-5802   |
| (439) 275-5002  |        NULL | 439      | 275-5002   |
| (553) 761-8526  |        NULL | 553      | 761-8526   |
| (330) 317-3260  |        NULL | 330      | 317-3260   |
| (793) 537-0227  |        NULL | 793      | 537-0227   |
| (367) 706-0447  |        NULL | 367      | 706-0447   |
| (620) 399-2377  |        NULL | 620      | 399-2377   |
| (391) 520-2816  |        NULL | 391      | 520-2816   |
| (136) 155-0342  |        NULL | 136      | 155-0342   |
| (878) 746-8732  |        NULL | 878      | 746-8732   |
| (869) 950-7777  |        NULL | 869      | 950-7777   |
| (346) 107-9046  |        NULL | 346      | 107-9046   |
| (569) 964-0253  |        NULL | 569      | 964-0253   |
| (475) 816-1004  |        NULL | 475      | 816-1004   |
| (725) 857-1097  |        NULL | 725      | 857-1097   |
| (698) 172-7372  |        NULL | 698      | 172-7372   |
| (981) 736-3792  |        NULL | 981      | 736-3792   |
| (657) 407-1675  |        NULL | 657      | 407-1675   |
| (466) 579-3267  |        NULL | 466      | 579-3267   |
| (983) 368-1507  |        NULL | 983      | 368-1507   |
| (786) 458-8601  |        NULL | 786      | 458-8601   |
| (354) 198-5030  |        NULL | 354      | 198-5030   |
| (149) 369-1695  |        NULL | 149      | 369-1695   |
| (361) 964-9279  |        NULL | 361      | 964-9279   |
| (379) 235-1644  |        NULL | 379      | 235-1644   |
| (566) 325-0433  |        NULL | 566      | 325-0433   |
| (219) 525-1191  |        NULL | 219      | 525-1191   |
| (677) 950-1255  |        NULL | 677      | 950-1255   |
| (688) 419-6102  |        NULL | 688      | 419-6102   |
| (533) 316-9295  |        NULL | 533      | 316-9295   |
| (462) 901-5262  |        NULL | 462      | 901-5262   |
| (245) 422-5333  |        NULL | 245      | 422-5333   |
| (882) 368-5510  |        NULL | 882      | 368-5510   |
| (496) 403-4685  |        NULL | 496      | 403-4685   |
| (398) 373-3241  |        NULL | 398      | 373-3241   |
| (694) 793-5879  |        NULL | 694      | 793-5879   |
| (348) 539-4214  |        NULL | 348      | 539-4214   |
| (968) 455-4730  |        NULL | 968      | 455-4730   |
| (875) 858-4572  |        NULL | 875      | 858-4572   |
| (895) 212-1031  |        NULL | 895      | 212-1031   |
| (759) 223-5391  |        NULL | 759      | 223-5391   |
| (668) 633-3815  |        NULL | 668      | 633-3815   |
| (323) 413-7069  |        NULL | 323      | 413-7069   |
| (648) 342-6096  |        NULL | 648      | 342-6096   |
| (929) 521-3906  |        NULL | 929      | 521-3906   |
| (486) 621-7392  |        NULL | 486      | 621-7392   |
| (435) 764-5848  |        NULL | 435      | 764-5848   |
| (919) 875-6545  |        NULL | 919      | 875-6545   |
| (403) 500-8533  |        NULL | 403      | 500-8533   |
| (639) 884-2557  |        NULL | 639      | 884-2557   |
| (532) 822-2676  |        NULL | 532      | 822-2676   |
| (132) 239-8228  |        NULL | 132      | 239-8228   |
| (737) 500-9927  |        NULL | 737      | 500-9927   |
| (495) 278-4667  |        NULL | 495      | 278-4667   |
| (138) 234-7461  |        NULL | 138      | 234-7461   |
| (821) 713-2972  |        NULL | 821      | 713-2972   |
| (899) 354-9609  |        NULL | 899      | 354-9609   |
| (895) 316-2615  |        NULL | 895      | 316-2615   |
| (666) 270-0985  |        NULL | 666      | 270-0985   |
| (470) 382-8117  |        NULL | 470      | 382-8117   |
| (305) 831-2727  |        NULL | 305      | 831-2727   |
| (771) 386-8454  |        NULL | 771      | 386-8454   |
| (667) 202-1942  |        NULL | 667      | 202-1942   |
| (222) 852-5376  |        NULL | 222      | 852-5376   |
| (414) 108-5268  |        NULL | 414      | 108-5268   |
| (765) 337-8274  |        NULL | 765      | 337-8274   |
| (903) 918-8276  |        NULL | 903      | 918-8276   |
| (192) 744-4834  |        NULL | 192      | 744-4834   |
| (451) 198-7309  |        NULL | 451      | 198-7309   |
| (585) 417-0600  |        NULL | 585      | 417-0600   |
| (814) 238-5737  |        NULL | 814      | 238-5737   |
| (944) 125-2712  |        NULL | 944      | 125-2712   |
| (357) 332-2386  |        NULL | 357      | 332-2386   |
| (504) 941-7697  |        NULL | 504      | 941-7697   |
| (492) 719-2566  |        NULL | 492      | 719-2566   |
| (831) 209-7988  |        NULL | 831      | 209-7988   |
| (898) 444-3041  |        NULL | 898      | 444-3041   |
| (388) 930-6692  |        NULL | 388      | 930-6692   |
+-----------------+-------------+----------+------------+
100 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------

mysql> SELECT content AS fullPhoneNumber,
content LIKE "1-%" OR NULL AS countryCode,
SUBSTRING_INDEX(SUBSTRING_INDEX(content, "-", 2), "-", -1) AS areaCode,
RIGHT(content, 8) AS lineNumber FROM Phone WHERE content NOT LIKE "%(%"
UNION ALL
SELECT content AS fullPhoneNumber,
content LIKE "1-%" OR NULL AS countryCode,
SUBSTRING_INDEX(SUBSTRING_INDEX(content, "(", -1), ")", 1) AS areaCode,
RIGHT(content, 8) AS lineNumber FROM Phone WHERE content LIKE "%(%" ORDER BY countryCode DESC LIMIT 100;

+-----------------+-------------+----------+------------+
| fullPhoneNumber | countryCode | areaCode | lineNumber |
+-----------------+-------------+----------+------------+
| 1-811-990-2618  |           1 | 811      | 990-2618   |
| 1-200-915-5809  |           1 | 200      | 915-5809   |
| 1-245-342-8807  |           1 | 245      | 342-8807   |
| 1-258-765-9937  |           1 | 258      | 765-9937   |
| 1-257-867-0566  |           1 | 257      | 867-0566   |
| 1-687-372-5982  |           1 | 687      | 372-5982   |
| 1-254-219-1949  |           1 | 254      | 219-1949   |
| 1-380-554-5763  |           1 | 380      | 554-5763   |
| 1-525-831-2277  |           1 | 525      | 831-2277   |
| 1-295-224-3944  |           1 | 295      | 224-3944   |
| 1-432-441-4780  |           1 | 432      | 441-4780   |
| 1-602-261-0181  |           1 | 602      | 261-0181   |
| 1-576-879-5834  |           1 | 576      | 879-5834   |
| 1-716-957-3905  |           1 | 716      | 957-3905   |
| 1-338-174-4888  |           1 | 338      | 174-4888   |
| 1-395-184-0701  |           1 | 395      | 184-0701   |
| 1-351-618-2388  |           1 | 351      | 618-2388   |
| 1-425-733-8123  |           1 | 425      | 733-8123   |
| 1-780-716-6922  |           1 | 780      | 716-6922   |
| 1-410-492-3992  |           1 | 410      | 492-3992   |
| 1-990-136-5147  |           1 | 990      | 136-5147   |
| 1-418-921-5849  |           1 | 418      | 921-5849   |
| 1-212-228-3810  |           1 | 212      | 228-3810   |
| 1-436-895-8796  |           1 | 436      | 895-8796   |
| 1-649-149-4033  |           1 | 649      | 149-4033   |
| 1-114-563-2897  |           1 | 114      | 563-2897   |
| 1-665-685-5382  |           1 | 665      | 685-5382   |
| 1-676-607-1551  |           1 | 676      | 607-1551   |
| 1-824-853-9469  |           1 | 824      | 853-9469   |
| 1-307-836-1109  |           1 | 307      | 836-1109   |
| 1-527-448-9647  |           1 | 527      | 448-9647   |
| 1-707-888-2787  |           1 | 707      | 888-2787   |
| 1-164-741-1817  |           1 | 164      | 741-1817   |
| 1-130-457-3860  |           1 | 130      | 457-3860   |
| 1-413-597-6316  |           1 | 413      | 597-6316   |
| 1-793-953-6677  |           1 | 793      | 953-6677   |
| 1-222-732-9450  |           1 | 222      | 732-9450   |
| 1-885-383-3316  |           1 | 885      | 383-3316   |
| 1-769-175-6037  |           1 | 769      | 175-6037   |
| 1-585-936-6793  |           1 | 585      | 936-6793   |
| 1-115-604-8551  |           1 | 115      | 604-8551   |
| 1-823-223-5247  |           1 | 823      | 223-5247   |
| 1-889-800-9270  |           1 | 889      | 800-9270   |
| 1-986-619-9252  |           1 | 986      | 619-9252   |
| 1-880-866-0045  |           1 | 880      | 866-0045   |
| 1-581-724-8616  |           1 | 581      | 724-8616   |
| 1-976-407-3722  |           1 | 976      | 407-3722   |
| 1-778-730-0178  |           1 | 778      | 730-0178   |
| 1-214-443-0290  |           1 | 214      | 443-0290   |
| 1-667-593-2501  |           1 | 667      | 593-2501   |
| 1-155-560-6351  |           1 | 155      | 560-6351   |
| 1-146-826-8368  |           1 | 146      | 826-8368   |
| 1-296-113-0411  |           1 | 296      | 113-0411   |
| 1-928-234-9600  |           1 | 928      | 234-9600   |
| 1-355-658-9356  |           1 | 355      | 658-9356   |
| 1-941-735-6014  |           1 | 941      | 735-6014   |
| 1-150-167-8225  |           1 | 150      | 167-8225   |
| 1-336-193-1111  |           1 | 336      | 193-1111   |
| 1-924-707-1487  |           1 | 924      | 707-1487   |
| 1-933-986-6219  |           1 | 933      | 986-6219   |
| 1-406-473-2934  |           1 | 406      | 473-2934   |
| 1-303-638-4150  |           1 | 303      | 638-4150   |
| 1-304-301-0026  |           1 | 304      | 301-0026   |
| 1-428-478-1655  |           1 | 428      | 478-1655   |
| 1-372-257-8577  |           1 | 372      | 257-8577   |
| 1-380-623-5789  |           1 | 380      | 623-5789   |
| 1-200-560-7225  |           1 | 200      | 560-7225   |
| 1-765-240-6001  |           1 | 765      | 240-6001   |
| 1-588-524-1323  |           1 | 588      | 524-1323   |
| 1-126-595-8699  |           1 | 126      | 595-8699   |
| 1-217-977-2013  |           1 | 217      | 977-2013   |
| 1-569-464-7758  |           1 | 569      | 464-7758   |
| 1-464-411-9555  |           1 | 464      | 411-9555   |
| 1-632-746-8879  |           1 | 632      | 746-8879   |
| 1-199-864-5100  |           1 | 199      | 864-5100   |
| 1-938-382-4660  |           1 | 938      | 382-4660   |
| 1-116-157-3520  |           1 | 116      | 157-3520   |
| 1-481-326-7608  |           1 | 481      | 326-7608   |
| 1-287-915-4975  |           1 | 287      | 915-4975   |
| 1-781-983-4034  |           1 | 781      | 983-4034   |
| 1-526-858-8854  |           1 | 526      | 858-8854   |
| 1-230-850-6706  |           1 | 230      | 850-6706   |
| 1-733-279-6746  |           1 | 733      | 279-6746   |
| 1-206-495-1425  |           1 | 206      | 495-1425   |
| 1-748-169-1118  |           1 | 748      | 169-1118   |
| 1-514-561-3156  |           1 | 514      | 561-3156   |
| 1-230-221-1403  |           1 | 230      | 221-1403   |
| 1-153-744-4476  |           1 | 153      | 744-4476   |
| 1-272-146-5304  |           1 | 272      | 146-5304   |
| 1-874-317-2489  |           1 | 874      | 317-2489   |
| 1-854-220-8547  |           1 | 854      | 220-8547   |
| 1-650-808-7230  |           1 | 650      | 808-7230   |
| 1-507-991-8513  |           1 | 507      | 991-8513   |
| 1-506-139-6333  |           1 | 506      | 139-6333   |
| 1-340-435-0028  |           1 | 340      | 435-0028   |
| 1-924-830-4859  |           1 | 924      | 830-4859   |
| 1-358-224-0501  |           1 | 358      | 224-0501   |
| 1-375-412-4731  |           1 | 375      | 412-4731   |
| 1-830-179-3094  |           1 | 830      | 179-3094   |
| 1-520-727-8601  |           1 | 520      | 727-8601   |
+-----------------+-------------+----------+------------+
100 rows in set (0.00 sec)